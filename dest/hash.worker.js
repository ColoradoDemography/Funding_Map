!function(r){function e(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=r,e.c=t,e.p="dest",e(0)}([function(r,e,t){"use strict";importScripts("https://d3js.org/d3.v3.min.js"),Array.prototype.findIndex||(Array.prototype.findIndex=function(r){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof r)throw new TypeError("predicate must be a function");for(var e,t=Object(this),n=t.length>>>0,o=arguments[1],a=0;a<n;a++)if(e=t[a],r.call(o,e,a,t))return a;return-1});var n=t(1),o=t(2).sortNumeric,a=t(3),i=t(4);onmessage=function(r){console.log("Message received from main script");var e=[],t=[];d3.csv("../data/funding.csv",function(r){d3.csv("../data/keypts.csv",function(u){u.forEach(function(r){e.indexOf(r.govname)===-1&&(e.push(r.govname),t.push([parseFloat(r.longitude),parseFloat(r.latitude)]),e.push(r.lgid),t.push([parseFloat(r.longitude),parseFloat(r.latitude)]))});var s=r.map(function(r){return a(r,u)}),l=s.filter(function(r){return!!r}),d=i(l);d.forEach(function(r){return n(r)}),d=d.sort(o),console.log("Posting message back to main script"),postMessage([d,e,t]),close()})})}},function(r,e){"use strict";var t=[];r.exports=function(r){function e(r){var e=(r-n)/864e5;return e}var n=new Date(2e3,0,1);t.indexOf(r.lgid)===-1&&t.push(r.lgid);var o=t.indexOf(r.lgid),a=1e8*o,i=r.program;"DR"===i&&(a+=1e5),"FML"===i&&(a+=12e5),"CTF"===i&&(a+=11e5),"SEV_DIST"===i&&(a+=1e6),"CSBG"===i&&(a+=6e5),"CDBG"!==i&&"CDBGED"!==i&&"CDBGPF"!==i||(a+=5e5),"EIAF"===i&&(a+=2e5),"GAME"===i&&(a+=3e5),"REDI"===i&&(a+=4e5),"MJ"!==i&&"GBMJ"!==i||(a+=13e5),"VFP"===i&&(a+=8e5),"SAR"!==i&&"SAR Tier 1"!==i&&"SAR Tier 3"!==i&&"SAR Tier 2"!==i&&"SAR EoY"!==i||(a+=7e5),"FFB"===i&&(a+=9e5);var u=Math.random();return a=a+e(r.dateofaward)+u,r.id=a,r}},function(r,e){"use strict";r.exports.sortNumeric=function(r,e){return r.id<e.id?1:-1},r.exports.monthNumStr=function(r){return"JAN"===r?0:"FEB"===r?1:"MAR"===r?2:"APR"===r?3:"MAY"===r?4:"JUN"===r?5:"JUL"===r?6:"AUG"===r?7:"SEP"===r?8:"OCT"===r?9:"NOV"===r?10:"DEC"===r?11:(console.log(r),console.log("unexpected fall through on monthNumStr"),99)}},function(r,e,t){"use strict";var n=t(2).monthNumStr;r.exports=function(r,e){function t(e,t,n){if(n[t].lgid===r.lgid)return!0}"FML_SB106"===r.program&&(r.program="FML");var o=r.dateofaward.split("-"),a=new Date(Number("20"+o[2]),n(o[1]),Number(o[0]));"null"===r.projectnmbr&&(r.projectnmbr=""),"null"===r.projname&&(r.projname=r.program+" Distribution");var i=e.findIndex(t);if(i>-1){var u={};return u.award=parseFloat(r.award),u.dateofaward=a,u.govname=e[i].govname,u.latitude=parseFloat(e[i].latitude),u.longitude=parseFloat(e[i].longitude),u.lgid=r.lgid,u.lgtype=parseInt(e[i].lgtype,10),u.program=r.program,u.projectnmbr=r.projectnmbr,u.projname=r.projname,u}console.log("problem? no match for "+r.lgid),console.log("please add an entry in the keypts.csv file for "+r.lgid)}},function(r,e){"use strict";r.exports=function(r){var e=[],t=r.map(function(r){var t=r.lgid;e.hasOwnProperty(t)?e[t]++:e[t]=0;var n=r.latitude+.002*e[t],o=r.longitude;return r.latLng=[n,o],r});return t}}]);